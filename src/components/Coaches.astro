---
import { Image } from 'astro:assets';
import DevanImage from "../../src/assets/images/devan-bonebrake.jpg";
import JackImage from "../../src/assets/images/jack-henneberry-beach-city-golf.jpg";
import CalvinImage from "../../src/assets/images/calvin-maranville-pga-beach-city-golf.jpg";
export interface Coach {
    name: string;
    title: string;
    titleSuffi?: string,
    imageSrc?: string;
    imageAlt?: string;
    bio: string;
    instagramLink?: string;
    buttonLabel: string;
    buttonURL: string;
}
export interface Props {
    theme: string;
    heading: string;
}

const coachesData = {
    heading: "Guidance From Our Experts",
    theme: "dark",
    coaches: [
        {
            name: "Devan Bonebrake",
            title: "Owner",
            imageSrc: DevanImage,
            imageAlt: "Headshot of Devan Bonebrake",
            buttonLabel: "Get Me Started",
            buttonURL: "https://generalstudentbooking.as.me/DevanBonebrakeLesson",
            instagramLink: "https://www.instagram.com/devan_bonebrake/",
            bio: "I'm Coach Devan Bonebrake, I'm the founder of the Southern California golf Academy as well as the host of the #1 show the GolfFix on GolfPass and the Golf Channel. I\'m originally from Portland Oregon, and played collegiate golf at College of the Desert in Palm Desert before transferring to San Diego State. Upon graduation from SDSU in 2007 I started working for Jim McLean at PGA West in La Quinta California. I started spending a great deal of time with Jim McLean and was subsequently asked by Jim to move to the TPC Doral location in Miami Florida to be his Personal Teaching Assistant. As Jim McLean\'s personal assistant I was fortunate to be able to teach with Jim in every golf lesson, clinic and school that he taught. Some of the notable players he worked with while Jim\'s Assistant were Greg Norman, Keegan Bradley, Lexi Thompson, Eric Compton, and Vaughn Taylor. Devan also aided Jim in the writing of his Death Moves book in 2009. In 2011 Devan was offered a Master Instructor position at The Jim McLean Junior Academy in Dallas/Fort Worth. He spent the next 5 years helping develop some of the best Junior golfers in the country. In addition to Jim McLean Devan has had the opportunity to spend significant time with Mike Bender, Jim Hardy, Hank Haney, Chuck Cook, Jim Flick, and Carl Welty. The culmination of this time has helped shape the way Devan teaches golf. Devan enjoys working with players of all abilities from the High Performance Junior to the Weekend Golfer, or just anyone looking to pick up the game and have fun!",
        },
        {
            name: "Calvin Maranville",
            title: "Lead Instructor",
            titleSuffix: "PGA",
            imageSrc: CalvinImage,
            imageAlt: "Headshot of Calvin Maranville, PGA",
            buttonLabel: "Get Me Started",
            buttonURL: "https://generalstudentbooking.as.me/CalvinMaranvilleNSA",
            instagramLink: "https://www.instagram.com/calvinmaranville_pga/",
            bio: "I am here to help you unlock your true potential on the green. From the moment I could hold a club, golf has been my passion. At the age of 12, I dedicated myself to this incredible sport, and since then, I have never looked back. With 9 years of competitive playing experience, including 2 years on the prestigious Golden State Tour, golf has shaped me into the teacher I am today. In 2012, I entered the golf industry, and in 2014, I discovered my true calling â€“ teaching. Witnessing the transformation of my students, seeing their smiles, and knowing that I have contributed to their growth is the most rewarding feeling I have ever experienced. As a Class A Teaching Professional, I bring expertise, knowledge, and a deep love for the game to every lesson. But it\'s not just about golf for me; it\'s about the life skills this game teaches us. Discipline, focus, perseverance - these are just a few of the invaluable qualities you will develop through golf. And let\'s not forget the addictive feeling of hitting a pure golf shot. It\'s a sensation that never gets old, and it will keep you coming back for more. Golf is a journey, and I am here to guide you every step of the way. Together, we will explore the endless opportunities for improvement in your game. And along the way, you will forge lifelong friendships, just as I have. Golf has always been my Zen, my sanctuary, and I can\'t wait to share this incredible journey with you. So, whether you are a beginner looking to take your first swing or an experienced golfer seeking to refine your skills, join me at Beach City Golf Club, and let\'s embark on an unforgettable golfing adventure together!",
        }
    ]
};

const { heading, theme, coaches } = coachesData;
---

<section class={`coaches ${theme ? `coaches-${theme}` : ""}`}>
    <div class="container">
      {heading && (<h2>{heading}</h2>)}
      <div class="coaches-grid">
        {coaches && Array.isArray(coaches) && coaches.map((coach, index) => (
          <div class="coaches-card" id={`coach-card-${index}`}>
            <div class="coaches-image">
              <Image src={coach.imageSrc} alt={coach.imageAlt || 'Card image'} />
            </div>
            {coach.name && 
                <h4 class="coaches-name">
                    {coach.name}{coach.titleSuffix && `, ${coach.titleSuffix}`}
                </h4>
            }
            {coach.title && 
                <p class="coaches-title">
                    {coach.title}
                </p>
            }
            {coach.buttonLabel && (
              <div class="coaches-controls">
                <a href={coach.buttonURL} class="button button--blue">{coach.buttonLabel}</a>
                <button class="button button-white-ghost meet-coach-button" data-index={index}>
                  Meet {coach.name}
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon-plus">
                    <path d="M240 64c0-8.8-7.2-16-16-16s-16 7.2-16 16l0 176L32 240c-8.8 0-16 7.2-16 16s7.2 16 16 16l176 0 0 176c0 8.8 7.2 16 16 16s16-7.2 16-16l0-176 176 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-176 0 0-176z"/>
                  </svg>
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon-minus">
                    <path d="M432 256c0 8.8-7.2 16-16 16L32 272c-8.8 0-16-7.2-16-16s7.2-16 16-16l384 0c8.8 0 16 7.2 16 16z"/>
                  </svg>
                </button>
              </div>
            )}
            <div class="coaches-bio coaches-bio-mobile">
              <div class="coach-bio" id={`coach-bio-mobile-${index}`} style="overflow: hidden;">
                <div class="coach-contact">
                  <ul class="coach-social">
                    <li>
                      <h3>Social</h3>
                    </li>
                    <li>
                        <a href={coach.instagramLink} target="_blank" aria-label="Link to our Instagram page. Link opens in a new tab.">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                <path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/>
                            </svg>
                        </a>
                    </li>
                  </ul>
                </div>
                <div class="coach-intro">
                  <p>{coach.bio}</p>
                </div>
              </div>
            </div>
          </div>
        ))}
      </div>
      <div class="coaches-bio coaches-bio-desktop">
        {coaches && Array.isArray(coaches) && coaches.map((coach, index) => (
          <div class="coach-bio" id={`coach-bio-desktop-${index}`} style="overflow: hidden;">
            <div class="coach-contact">
              <ul class="coach-social">
                <li>
                  <h3>Social</h3>
                </li>
                <li>
                    <a href={coach.instagramLink} target="_blank" aria-label="Link to our Instagram page. Link opens in a new tab.">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                            <path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/>
                        </svg>
                    </a>
                </li>
              </ul>
            </div>
            <div class="coach-intro">
              <p>{coach.bio}</p>
            </div>
          </div>
        ))}
      </div>
    </div>
</section>

<style>
    .coaches {
        padding: 40px 16px;
        background: var(--white);

        @media (min-width: 750px) {
            padding: 96px 16px 46px;
        }

        &.coaches-dark {
            background: var(--black100);
            color: var(--white);
        }

        .container {
            width: 100%;
        }

        h2 {
            margin: 0 0 32px;
            font-family: "proxima-nova-extra-condensed", sans-serif;
            font-size: 40px;
            font-weight: 600;
            letter-spacing: -1px;
            line-height: 1.15;
            text-transform: uppercase;
            @media (min-width: 750px) {
                max-width: 500px;
                font-size: 48px;
            }
        }

        .coaches-grid {
            display: grid;
            gap: 40px;
            grid-template-columns: 1fr;

            @media (min-width: 750px) {
                gap: 48px;
                grid-template-columns: 1fr 1fr 1fr;
            }
        }

        .coaches-image {
            margin-bottom: 20px;
            border-radius: 2px;
            overflow: hidden;

            img {
                width: 100%;
            }
        }

        .coaches-name,
        .coaches-title {
            margin: 0;
            font-family: "proxima-nova-extra-condensed", sans-serif;
            font-weight: 600;
            letter-spacing: -1px;
            line-height: 1.25;
            text-transform: uppercase;
        }

        .coaches-name {
            font-size: 36px;
        }

        .coaches-title {
            font-size: 22px;
        }

        .coaches-controls {
            display: flex;
            gap: 18px;
            margin: 22px 0 0;
        }
        .coaches-bio {
            position: relative;
            margin-top: 40px;
            padding: 40px 0;

            &.expanded  {
                border-top: 1px solid var(--white);
            }
        }

        .coach-social {
            svg {
                height: 36px;
                width: 36px;
                fill: var(--blue100);
            }
        }

        .meet-coach-button {
            display: flex;
            gap: 14px;
            align-items: center;
            cursor: pointer;

                @media(hover: hover) and (pointer: fine) {
                &:hover {
                    svg {
                        fill: var(--black);
                    }
                }
            }

            .icon-minus,
            .icon-plus {
                width: 20px;
                fill: var(--white);
                transition: ease 0.25s;
            }

            .icon-minus {
                display: none;
            }

            &.expanded {
                background: var(--white);
                color: var(--black);

                .icon-plus {
                    display: none;
                }
                .icon-minus {
                    display: inline-block;
                    fill: var(--black);
                }
            }
        }
        @media (max-width: 750px) {
            .coaches-bio-desktop {
                display: none;
            }
        }

        @media (min-width: 750px) {
            .coaches-bio-mobile {
                display: none;
            }
        }

        .coaches-bio-mobile {
            display: none;

            &.expanded {
                display: flex;

                @media (min-width: 750px) {
                    display: none;
                }
            }
        }


        .coach-bio {
            display: flex;
            flex-direction: column;

            @media (min-width: 750px) {
                flex-direction: row;
            }

            .coach-contact {
                @media (min-width: 750px) {
                    width: 33.333%;
                }

                ul {
                    h3 {
                        font-family: "proxima-nova-extra-condensed", sans-serif;
                        font-size: 22px;
                        text-transform: uppercase;
                    }
                }
            }
            .coach-intro {
                @media (min-width: 750px) {
                    width: 66.667%;
                }
            }
            p {
                font-size: 18px;
                @media (min-width: 750px) {
                    font-size: 20px;
                }
            }

            ul {
                padding-left: 0;
            }
        }
    }
</style>

<script>
import gsap from "gsap";

document.addEventListener('DOMContentLoaded', function() {
    const buttons = document.querySelectorAll('.meet-coach-button');
    const mobileBios = document.querySelectorAll('.coach-bio-mobile .coach-bio');
    const desktopBios = document.querySelectorAll('.coaches-bio-desktop .coach-bio');

    // Initially set all bios to hidden with GSAP
    gsap.set(mobileBios, { autoAlpha: 0, height: 0 });
    gsap.set(desktopBios, { autoAlpha: 0, height: 0 });

    // Debounce function to prevent multiple rapid clicks
    function debounce(func, wait) {
        let timeout;
        return function(...args) {
            const context = this;
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(context, args), wait);
        };
    }

    function toggleBio(button, bio, bios, isMobile) {
        const isExpanded = button.classList.contains("expanded");
        const mobileBioContainer = bio.closest('.coaches-bio.coaches-bio-mobile');

        if (!isExpanded) {
            if (!isMobile) {
                buttons.forEach(btn => btn.classList.remove("expanded"));
                gsap.to(bios, {
                    duration: 0.5,
                    autoAlpha: 0,
                    height: 0,
                    overflow: 'hidden',
                    ease: "power2.inOut",
                    onComplete: () => {
                        bios.forEach(b => b.classList.remove("active"));
                    }
                });
            }
            button.classList.add("expanded");
            bio.classList.add("active");
            if (isMobile && mobileBioContainer) {
                mobileBioContainer.classList.add('expanded');
            }
            gsap.to(bio, {
                duration: 0.5,
                autoAlpha: 1,
                height: "auto",
                overflow: 'visible',
                ease: "power2.inOut",
                onComplete: () => {
                    button.focus();
                }
            });
        } else {
            button.classList.remove("expanded");
            bio.classList.remove("active");
            if (isMobile && mobileBioContainer) {
                mobileBioContainer.classList.remove('expanded');
            }
            gsap.to(bio, {
                duration: 0.5,
                autoAlpha: 0,
                height: 0,
                overflow: 'hidden',
                ease: "power2.inOut",
                onComplete: () => {
                    button.focus();
                }
            });
        }
    }

    buttons.forEach(button => {
        button.addEventListener('click', debounce(function(event) {
            event.preventDefault();
            const index = button.getAttribute('data-index');
            const mobileBio = document.getElementById(`coach-bio-mobile-${index}`);
            const desktopBio = document.getElementById(`coach-bio-desktop-${index}`);

            const isMobile = window.innerWidth < 768;
            const bio = isMobile ? mobileBio : desktopBio;
            const bios = isMobile ? mobileBios : desktopBios;

            toggleBio(button, bio, bios, isMobile);
        }, 250)); // Debounce wait time set to 250ms
    });

    // Handle window resize
    window.addEventListener('resize', debounce(() => {
        const isMobile = window.innerWidth < 768;
        buttons.forEach(button => button.classList.remove('expanded'));
        if (isMobile) {
            gsap.set(mobileBios, { autoAlpha: 0, height: 0 });
            mobileBios.forEach(bio => {
                bio.classList.remove('active');
                const mobileBioContainer = bio.closest('.coaches-bio.coaches-bio-mobile');
                if (mobileBioContainer) {
                    mobileBioContainer.classList.remove('expanded');
                }
            });
        } else {
            gsap.set(desktopBios, { autoAlpha: 0, height: 0 });
            desktopBios.forEach(bio => bio.classList.remove('active'));
        }
    }, 250));
});
</script>